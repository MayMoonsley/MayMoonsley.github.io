<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Let's Generate Cobblestone Textures</title>
    <link rel="stylesheet" type="text/css" href="../../main.css">
  </head>
  <body onload="init()">
    <h1>Let's Generate Cobblestone Textures</h1>
    <p>This year's GHP campus, <a href="http://www.berry.edu/">Berry College</a>, had a lot of cobblestone walkways, so I wanted to try to figure out how to generate passable cobblestone textures. My first thought was a <a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi diagram</a>, but the basic form seemed wrong. Cobblestone has mortar bits in-between the stones, while a Voronoi diagram has all the "stones" right up against eachother.</p>
    <figure class="flexImgs">
      <img src="../../imgs/cobble.jpg">
      <img src="../../imgs/voronoi.png">
      <figcaption>Not super similar. (Cobblestone photo by <a href="https://commons.wikimedia.org/wiki/User:AlMare">AlMare</a>. Voronoi diagram generated by me.)</figcaption>
    </figure>
    <aside>
      <p>A Voronoi diagram is, for the uninitiated, what happens when you take a bunch of points (apparently called "seeds" if Wikipedia is to be believed), throw them randomly onto a plane, and divide the plane up based on which seed the points on the plane are closest to. (The Wikipedia article linked above does a better, if denser, job of explaining it.)</p>
    </aside>
    <p>The actual shapes of the Voronoi polygons are about right (the cobbles at Berry were more angular), but there needed to be more separation between them. I thought for a while about how to accomplish that. The solution soon hit me. The mortar shows up on the edges of the Voronoi regions. How do you mathematically describe those points? To help answer that question, let's look at a small Voronoi diagram. (The little dots are the seeds.)</p>
    <figure class="flexImgs">
      <img src="../../imgs/voronoiExp1.png">
    </figure>
    <p>If we highlight the regions that should be mortar, it'd look something like this:</p>
    <figure class="flexImgs">
      <img src="../../imgs/voronoiExp2.png">
    </figure>
    <p>If you look carefully, you should notice that the mortar regions are almost equidistant from the points around them. So if, when you paint out the Voronoi stuff, you make all the regions that are almost equally close to two points, you get...these!</p>
    <figure class="flexImgs">
      <img src="../../imgs/voronoiNoCull.png">
      <img src="../../imgs/voronoiNoCull2.png">
      <figcaption>These are alright, but I'm not a fan of the large empty spaces. You'd never see mortar-covered spaces so large. (At least, you wouldn't at Berry.) How do I solve this?</figcaption>
    </figure>
    <p>I realized that the empty spaces are caused when two seeds are too close together - so close that they cancel eachother out, making large seas of mortar. So, add in a culling process where all points too close together are removed, and you get this!</p>
    <div>
      <h2>Final Results</h2>
      <canvas class="center" id="screen" width="512" height="512"></canvas>
      <p class="center">Number of Points: <input type="number" id="numPoints" value="32"> Threshold Distance: <input type="number" id="dist" value="8"> Culling Distance: <input type="number" id="cullDist" value="16"> <button type="button" onclick="update()">Re-Generate!</button></p>
    </div>
    <p>Feel free to mess around with this and use the resulting images for whatever. (Please drop me a line if you do, though.) I recognize that the colors are pretty unrealistic, but I'm not sure how to realistically generate stone textures. Perhaps that'll be a project for another day.</p>
    <hr>
    <p class="back"><a href="../index.html">Back to Blog Index</a></p>
    <script src="voronoi.js"></script>
  </body>
</html>